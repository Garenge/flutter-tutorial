# Flutter 样式系统详解

## 你的代码解析

```dart
Text(
  '$_counter',
  style: Theme.of(context).textTheme.headlineMedium,
)
```

### 逐部分解释

**`style:`** 
- 这是 `Text` Widget 的一个属性
- 用于设置文本的样式（字体、颜色、大小等）
- 类型是 `TextStyle?`（可选）

**`Theme.of(context)`**
- 从当前上下文（context）获取应用的主题（Theme）
- `Theme` 包含了应用的整体样式配置

**`.textTheme`**
- `Theme` 的一个属性
- 包含文本相关的样式主题
- 类型是 `TextTheme`

**`.headlineMedium`**
- `TextTheme` 的一个预定义样式
- 表示"中等大小的标题"样式
- 返回 `TextStyle` 对象

**整体含义**：
从应用主题中获取预定义的"中等标题"文本样式，并应用到这段文本上。

## Theme 和 TextTheme

### MaterialApp 中的 Theme 配置

```dart
MaterialApp(
  theme: ThemeData(
    textTheme: TextTheme(
      headlineLarge: TextStyle(fontSize: 32, fontWeight: FontWeight.bold),
      headlineMedium: TextStyle(fontSize: 28, fontWeight: FontWeight.bold),
      headlineSmall: TextStyle(fontSize: 24, fontWeight: FontWeight.bold),
      bodyLarge: TextStyle(fontSize: 16),
      bodyMedium: TextStyle(fontSize: 14),
      bodySmall: TextStyle(fontSize: 12),
    ),
  ),
)
```

### TextTheme 的预定义样式

Flutter 提供了以下预定义文本样式：

- `displayLarge` - 超大显示文本
- `displayMedium` - 大显示文本
- `displaySmall` - 中等显示文本
- `headlineLarge` - 大标题
- `headlineMedium` - 中等标题（你用的这个）
- `headlineSmall` - 小标题
- `titleLarge` - 大标题
- `titleMedium` - 中等标题
- `titleSmall` - 小标题
- `bodyLarge` - 大正文
- `bodyMedium` - 中等正文
- `bodySmall` - 小正文
- `labelLarge` - 大标签
- `labelMedium` - 中等标签
- `labelSmall` - 小标签

## 创建自定义样式文件

### 方法 1：创建样式常量文件

**文件结构**：
```
lib/
├── main.dart
└── styles/
    └── text_styles.dart
```

**创建 `lib/styles/text_styles.dart`**：

```dart
import 'package:flutter/material.dart';

class AppTextStyles {
  // 私有构造函数，防止实例化
  AppTextStyles._();

  // 标题样式
  static const TextStyle heading1 = TextStyle(
    fontSize: 32,
    fontWeight: FontWeight.bold,
    color: Colors.black87,
    fontFamily: 'Menlo',
  );

  static const TextStyle heading2 = TextStyle(
    fontSize: 24,
    fontWeight: FontWeight.w600,
    color: Colors.black87,
  );

  // 正文样式
  static const TextStyle bodyLarge = TextStyle(
    fontSize: 16,
    color: Colors.black54,
    height: 1.5,
  );

  static const TextStyle bodyMedium = TextStyle(
    fontSize: 14,
    color: Colors.black54,
  );

  // 特殊样式
  static const TextStyle counter = TextStyle(
    fontSize: 48,
    fontWeight: FontWeight.bold,
    color: Colors.deepPurple,
  );

  static const TextStyle buttonText = TextStyle(
    fontSize: 16,
    fontWeight: FontWeight.w600,
    color: Colors.white,
  );
}
```

**使用方式**：

```dart
import 'styles/text_styles.dart';

Text(
  '$_counter',
  style: AppTextStyles.counter,  // 使用自定义样式
)
```

### 方法 2：创建样式扩展（Extension）

**创建 `lib/styles/text_style_extensions.dart`**：

```dart
import 'package:flutter/material.dart';

extension TextStyleExtensions on TextStyle {
  // 修改颜色
  TextStyle withColor(Color color) {
    return copyWith(color: color);
  }

  // 修改大小
  TextStyle withSize(double size) {
    return copyWith(fontSize: size);
  }

  // 修改粗细
  TextStyle withWeight(FontWeight weight) {
    return copyWith(fontWeight: weight);
  }
}
```

**使用方式**：

```dart
import 'styles/text_style_extensions.dart';

Text(
  'Hello',
  style: TextStyle(fontSize: 16)
    .withColor(Colors.red)
    .withWeight(FontWeight.bold),
)
```

### 方法 3：创建主题配置文件

**创建 `lib/theme/app_theme.dart`**：

```dart
import 'package:flutter/material.dart';

class AppTheme {
  static ThemeData get lightTheme {
    return ThemeData(
      useMaterial3: true,
      colorScheme: ColorScheme.fromSeed(seedColor: Colors.deepPurple),
      textTheme: const TextTheme(
        // 自定义文本主题
        headlineLarge: TextStyle(
          fontSize: 32,
          fontWeight: FontWeight.bold,
          fontFamily: 'Menlo',
        ),
        headlineMedium: TextStyle(
          fontSize: 28,
          fontWeight: FontWeight.w600,
          color: Colors.deepPurple,
        ),
        bodyLarge: TextStyle(
          fontSize: 16,
          color: Colors.black87,
        ),
      ),
      // 其他主题配置...
    );
  }

  static ThemeData get darkTheme {
    return ThemeData(
      useMaterial3: true,
      colorScheme: ColorScheme.fromSeed(seedColor: Colors.blue),
      textTheme: const TextTheme(
        headlineLarge: TextStyle(
          fontSize: 32,
          fontWeight: FontWeight.bold,
          color: Colors.white,
        ),
        // ...
      ),
    );
  }
}
```

**在 main.dart 中使用**：

```dart
import 'theme/app_theme.dart';

MaterialApp(
  theme: AppTheme.lightTheme,
  darkTheme: AppTheme.darkTheme,
  // ...
)
```

## 实际项目示例

### 完整的样式文件结构

```
lib/
├── main.dart
├── styles/
│   ├── text_styles.dart      # 文本样式
│   ├── color_styles.dart     # 颜色样式
│   ├── spacing_styles.dart   # 间距样式
│   └── app_styles.dart      # 统一导出
└── theme/
    └── app_theme.dart        # 主题配置
```

**`lib/styles/text_styles.dart`**：

```dart
import 'package:flutter/material.dart';

class AppTextStyles {
  AppTextStyles._();

  // 标题
  static const TextStyle h1 = TextStyle(
    fontSize: 32,
    fontWeight: FontWeight.bold,
    letterSpacing: -0.5,
  );

  static const TextStyle h2 = TextStyle(
    fontSize: 24,
    fontWeight: FontWeight.w600,
  );

  static const TextStyle h3 = TextStyle(
    fontSize: 20,
    fontWeight: FontWeight.w600,
  );

  // 正文
  static const TextStyle body1 = TextStyle(
    fontSize: 16,
    height: 1.5,
  );

  static const TextStyle body2 = TextStyle(
    fontSize: 14,
    height: 1.4,
  );

  // 特殊用途
  static const TextStyle caption = TextStyle(
    fontSize: 12,
    color: Colors.grey,
  );

  static const TextStyle button = TextStyle(
    fontSize: 16,
    fontWeight: FontWeight.w600,
    letterSpacing: 0.5,
  );
}
```

**`lib/styles/color_styles.dart`**：

```dart
import 'package:flutter/material.dart';

class AppColors {
  AppColors._();

  static const Color primary = Color(0xFF6200EE);
  static const Color secondary = Color(0xFF03DAC6);
  static const Color error = Color(0xFFB00020);
  static const Color background = Color(0xFFF5F5F5);
  static const Color surface = Colors.white;
}
```

**`lib/styles/app_styles.dart`**（统一导出）：

```dart
export 'text_styles.dart';
export 'color_styles.dart';
export 'spacing_styles.dart';
```

**使用**：

```dart
import 'styles/app_styles.dart';

Text(
  'Hello',
  style: AppTextStyles.h1.copyWith(color: AppColors.primary),
)
```

## 对比：三种方式

### 1. 直接使用 TextStyle（简单场景）

```dart
Text(
  'Hello',
  style: TextStyle(fontSize: 16, color: Colors.red),
)
```

**优点**：简单直接  
**缺点**：样式分散，难以统一管理

### 2. 使用 Theme（应用级统一）

```dart
Text(
  'Hello',
  style: Theme.of(context).textTheme.headlineMedium,
)
```

**优点**：统一管理，支持主题切换  
**缺点**：需要配置 Theme

### 3. 自定义样式类（项目级统一）

```dart
Text(
  'Hello',
  style: AppTextStyles.heading1,
)
```

**优点**：灵活，易于维护，类型安全  
**缺点**：需要额外文件

## 最佳实践

1. **小项目**：直接使用 `TextStyle` 或 `Theme`
2. **中大型项目**：创建自定义样式文件
3. **团队协作**：统一使用样式常量类
4. **主题切换**：使用 `Theme` 配置

## 总结

**你的代码含义**：
- `style:` → 设置文本样式
- `Theme.of(context)` → 获取应用主题
- `.textTheme.headlineMedium` → 使用预定义的"中等标题"样式

**可以创建自定义样式文件吗？**
- ✅ **完全可以！**
- 推荐创建 `styles/text_styles.dart` 文件
- 使用静态常量类管理样式
- 便于统一管理和维护

