# 12-圆角和边框

这篇教程整理 Flutter 中**圆角**与**边框**相关的常用写法与常见坑，帮助你在 `Container`、图片、按钮、水波纹、输入框等场景中写出一致且可控的 UI。

---

## 1. 核心概念：约束、绘制、裁剪

在 Flutter 里，圆角/边框通常会涉及三件事：

- **绘制（paint）**：`BoxDecoration` 画背景色、渐变、图片、阴影、边框。
- **裁剪（clip）**：决定“内容是否被圆角裁掉”。比如 `Container` 画了圆角，但 child（例如图片）是否跟着圆角裁剪，取决于有没有 clip。
- **命中区域（hit test）**：手势响应区域可能仍是矩形（即便视觉是圆角），需要 `ClipRRect` / `Material` 控制。

一句话总结：

- 只写 `borderRadius`：往往只是**背景**有圆角。
- 要让 child（图片、Ink 水波纹）也圆角：通常还需要**裁剪**或使用 `Material`。

---

## 2. 最常用：Container + BoxDecoration

### 2.1 圆角背景

```dart
Container(
  padding: const EdgeInsets.all(12),
  decoration: BoxDecoration(
    color: Colors.blue,
    borderRadius: BorderRadius.circular(12),
  ),
  child: const Text('圆角背景'),
)
```

### 2.2 圆角 + 边框

```dart
Container(
  padding: const EdgeInsets.all(12),
  decoration: BoxDecoration(
    color: Colors.white,
    borderRadius: BorderRadius.circular(12),
    border: Border.all(
      color: Colors.black12,
      width: 1,
    ),
  ),
  child: const Text('圆角 + 边框'),
)
```

### 2.3 只要部分圆角（左上/右下等）

```dart
Container(
  decoration: const BoxDecoration(
    color: Colors.orange,
    borderRadius: BorderRadius.only(
      topLeft: Radius.circular(12),
      bottomRight: Radius.circular(12),
    ),
  ),
)
```

### 2.4 圆形（头像/圆点）

```dart
Container(
  width: 48,
  height: 48,
  decoration: const BoxDecoration(
    color: Colors.green,
    shape: BoxShape.circle,
  ),
)
```

注意：`shape: BoxShape.circle` 与 `borderRadius` **不能同时生效**（二选一）。

---

## 3. 让内容也“圆角”：ClipRRect / ClipOval

### 3.1 图片圆角（推荐套路）

```dart
ClipRRect(
  borderRadius: BorderRadius.circular(12),
  child: Image.asset(
    'assets/images/common/app_icon.png',
    width: 120,
    height: 120,
    fit: BoxFit.cover,
  ),
)
```

### 3.2 圆形裁剪（头像）

```dart
ClipOval(
  child: Image.network(
    url,
    width: 64,
    height: 64,
    fit: BoxFit.cover,
  ),
)
```

### 3.3 常见坑：Container 有圆角但图片没圆角

```dart
Container(
  decoration: BoxDecoration(
    borderRadius: BorderRadius.circular(12),
  ),
  child: Image.asset(...),
)
```

这种写法，**装饰层**可能是圆角，但 `Image` 仍会按矩形绘制。

解决：

- 外层包 `ClipRRect`；或
- 使用 `DecoratedBox` + `clipBehavior`（仅部分组件支持）；或
- 用 `DecorationImage` 把图片放在 `BoxDecoration` 里（见下一节）。

---

## 4. DecorationImage：用 decoration 承载图片（无需再放 Image child）

当你希望“背景图 + 圆角 + 边框”一把梭，可以把图片放进 `BoxDecoration`：

```dart
Container(
  width: 120,
  height: 120,
  decoration: BoxDecoration(
    borderRadius: BorderRadius.circular(12),
    border: Border.all(color: Colors.black12),
    image: const DecorationImage(
      image: AssetImage('assets/images/common/app_icon.png'),
      fit: BoxFit.cover,
    ),
  ),
)
```

这种方式通常不需要额外 `ClipRRect`，但注意如果你在 `Container` 外叠加了其他内容（如 Stack），仍可能需要 clip。

---

## 5. 边框的进阶：不同方向、渐变边框

### 5.1 不同方向不同边框（Border）

```dart
Container(
  decoration: const BoxDecoration(
    color: Colors.white,
    border: Border(
      top: BorderSide(color: Colors.red, width: 2),
      bottom: BorderSide(color: Colors.blue, width: 2),
    ),
  ),
)
```

### 5.2 “渐变边框”的常用做法（外层渐变 + 内层留白）

```dart
Container(
  decoration: BoxDecoration(
    gradient: const LinearGradient(
      colors: [Colors.pink, Colors.orange],
    ),
    borderRadius: BorderRadius.circular(16),
  ),
  padding: const EdgeInsets.all(2), // 这里控制边框粗细
  child: Container(
    decoration: BoxDecoration(
      color: Colors.white,
      borderRadius: BorderRadius.circular(14),
    ),
    padding: const EdgeInsets.all(12),
    child: const Text('渐变边框'),
  ),
)
```

---

## 6. Material / InkWell：圆角 + 水波纹（非常常用）

很多同学会写：

```dart
Container(
  decoration: BoxDecoration(
    color: Colors.blue,
    borderRadius: BorderRadius.circular(12),
  ),
  child: InkWell(
    onTap: () {},
    child: const Padding(
      padding: EdgeInsets.all(12),
      child: Text('按钮'),
    ),
  ),
)
```

然后发现：

- 水波纹溢出圆角
- 或水波纹不显示（因为没有 `Material`）

推荐写法：`Material` + `InkWell`，并让两者 radius 一致：

```dart
final radius = BorderRadius.circular(12);

Material(
  color: Colors.blue,
  borderRadius: radius,
  child: InkWell(
    borderRadius: radius,
    onTap: () {},
    child: const Padding(
      padding: EdgeInsets.symmetric(horizontal: 16, vertical: 12),
      child: Text('圆角水波纹按钮', style: TextStyle(color: Colors.white)),
    ),
  ),
)
```

要点：

- `InkWell` 的水波纹依赖 `Material`。
- `Material.borderRadius` 与 `InkWell.borderRadius` 需要一致。

---

## 7. TextField / InputDecoration：输入框边框与圆角

### 7.1 最常见：OutlineInputBorder

```dart
TextField(
  decoration: InputDecoration(
    hintText: '请输入',
    border: OutlineInputBorder(
      borderRadius: BorderRadius.circular(12),
      borderSide: const BorderSide(color: Colors.black12),
    ),
    enabledBorder: OutlineInputBorder(
      borderRadius: BorderRadius.circular(12),
      borderSide: const BorderSide(color: Colors.black12),
    ),
    focusedBorder: OutlineInputBorder(
      borderRadius: BorderRadius.circular(12),
      borderSide: const BorderSide(color: Colors.blue, width: 2),
    ),
  ),
)
```

提示：

- 如果只设置 `border`，在不同状态（enabled/focused/error）下可能仍会被默认样式覆盖。
- 通常建议同时配置 `enabledBorder`、`focusedBorder`（以及需要的话 `errorBorder`）。

### 7.2 填充背景 + 无边框

```dart
TextField(
  decoration: InputDecoration(
    hintText: '请输入',
    filled: true,
    fillColor: const Color(0xFFF6F7F9),
    border: OutlineInputBorder(
      borderRadius: BorderRadius.circular(12),
      borderSide: BorderSide.none,
    ),
  ),
)
```

---

## 8. 常见坑与排查清单

- **只设置圆角但 child 没圆角**
  - **现象**：背景圆角了，图片/内容仍是直角。
  - **修复**：外包 `ClipRRect`，或用 `DecorationImage`。

- **InkWell 水波纹不显示 / 溢出圆角**
  - **原因**：缺少 `Material`；或 `borderRadius` 不一致。
  - **修复**：用 `Material + InkWell`，并统一 `BorderRadius`。

- **边框看起来“缺角”或有锯齿**
  - **可能原因**：缩放/非整数像素、边框太细、颜色对比强。
  - **建议**：边框使用 `1` 或 `2`，并尽量让尺寸是整数；必要时用更柔和的颜色。

- **圆角 + 阴影（BoxShadow）被裁掉**
  - **原因**：外层被 clip 了（例如 `ClipRRect`/`ClipRect`）。
  - **建议**：让“阴影容器”在外层，不要裁剪阴影层；只裁剪内容层。

---

## 9. 推荐组合（直接套用）

### 9.1 圆角卡片（背景 + 边框 + 阴影）

```dart
Container(
  decoration: BoxDecoration(
    color: Colors.white,
    borderRadius: BorderRadius.circular(12),
    border: Border.all(color: Colors.black12),
    boxShadow: const [
      BoxShadow(
        color: Color(0x14000000),
        blurRadius: 12,
        offset: Offset(0, 6),
      ),
    ],
  ),
  padding: const EdgeInsets.all(12),
  child: const Text('卡片内容'),
)
```

### 9.2 可点击卡片（圆角 + 水波纹 + 边框）

```dart
final radius = BorderRadius.circular(12);

Material(
  color: Colors.white,
  borderRadius: radius,
  child: InkWell(
    borderRadius: radius,
    onTap: () {},
    child: Ink(
      decoration: BoxDecoration(
        borderRadius: radius,
        border: Border.all(color: Colors.black12),
      ),
      child: const Padding(
        padding: EdgeInsets.all(12),
        child: Text('可点击卡片'),
      ),
    ),
  ),
)
```

---

## 10. 小结

- 圆角常用入口：`BorderRadius.circular` / `BorderRadius.only`。
- 边框常用入口：`Border.all` / `Border(...)`。
- “看起来圆角”不等于“内容被裁剪”：需要 `ClipRRect` 或 `DecorationImage`。
- 涉及点击水波纹：优先用 `Material + InkWell` 并统一 `borderRadius`。
- 输入框边框：用 `OutlineInputBorder`，记得配置 `enabledBorder/focusedBorder`。
