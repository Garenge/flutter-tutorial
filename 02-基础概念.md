# 02 - 基础概念

## 什么是 Flutter？

Flutter 是 Google 推出的开源 UI 工具包，用于构建：
- 移动应用（iOS 和 Android）
- Web 应用
- 桌面应用（Windows、macOS、Linux）

## 核心特点

### 1. 跨平台
一套代码可以运行在多个平台上，大大提高了开发效率。

### 2. 高性能
- 使用 Dart 语言编译为原生代码
- 自绘引擎，不依赖平台原生组件
- 60fps 流畅体验

### 3. 热重载（Hot Reload）
修改代码后立即看到效果，无需重启应用。

### 4. 丰富的 Widget
提供大量预构建的 Widget，快速构建 UI。

## Dart 语言基础

Flutter 使用 Dart 语言开发。以下是 Dart 的基础语法：

### 变量声明

```dart
// 使用 var 自动推断类型
var name = 'Flutter';

// 明确指定类型
String name = 'Flutter';
int age = 25;

// 常量
final String apiKey = 'xxx';
const double pi = 3.14;
```

### 函数

```dart
// 普通函数
String greet(String name) {
  return 'Hello, $name!';
}

// 箭头函数
String greet(String name) => 'Hello, $name!';

// 可选参数
void printInfo(String name, [int? age]) {
  print('Name: $name');
  if (age != null) {
    print('Age: $age');
  }
}
```

### 类

```dart
class Person {
  String name;
  int age;
  
  Person(this.name, this.age);
  
  void introduce() {
    print('I am $name, $age years old');
  }
}
```

**重要概念**：
- **类定义** ≠ **对象创建**
- `class Person { ... }` 只是定义了类的"模板"（蓝图），不会创建实际对象
- `Person(this.name, this.age)` 是**构造函数**，定义了如何创建对象
- 要创建对象，需要调用构造函数：`Person person = Person('Alice', 25);`

**构造函数的语法**：
- `Person(this.name, this.age)` 是 Dart 的简写形式（语法糖）
- 等价于完整写法：
  ```dart
  Person(String name, int age) {
    this.name = name;
    this.age = age;
  }
  ```

**使用示例**：
```dart
// 1. 定义类（模板）
class Person {
  String name;
  int age;
  Person(this.name, this.age);
  void introduce() {
    print('I am $name, $age years old');
  }
}

// 2. 创建对象（实例化）
Person alice = Person('Alice', 25);
Person bob = Person('Bob', 30);

// 3. 使用对象
alice.introduce();  // 输出: I am Alice, 25 years old
bob.introduce();    // 输出: I am Bob, 30 years old
```

**构造函数中使用可选参数**：

```dart
// 方式 1：可选位置参数
class Person {
  String name;
  int? age;
  String? city;
  
  Person(this.name, [this.age, this.city]);
  
  void introduce() {
    print('I am $name');
    if (age != null) print('Age: $age');
    if (city != null) print('City: $city');
  }
}

// 使用
Person p1 = Person('Alice');                    // 只传 name
Person p2 = Person('Bob', 25);                  // 传 name 和 age
Person p3 = Person('Charlie', 30, 'Beijing');   // 传所有参数

// 方式 2：可选命名参数（推荐）
class Person2 {
  String name;
  int? age;
  String? city;
  
  Person2(this.name, {this.age, this.city});
  
  void introduce() {
    print('I am $name');
    if (age != null) print('Age: $age');
    if (city != null) print('City: $city');
  }
}

// 使用
Person2 p1 = Person2('Alice');                          // 只传 name
Person2 p2 = Person2('Bob', age: 25);                   // 传 name 和 age
Person2 p3 = Person2('Charlie', city: 'Beijing');      // 传 name 和 city（跳过 age）
Person2 p4 = Person2('David', age: 30, city: 'Shanghai'); // 传所有参数

**为什么需要花括号 `{}`？为什么不能用方括号 `[]` 按名称传递？**

**核心区别**：
- **可选位置参数 `[]`**：按**位置**识别参数（第1个、第2个...）
- **可选命名参数 `{}`**：按**名称**识别参数（`age:`, `city:`）

**可选位置参数的限制**：
```dart
void func(int a, [int? b, int? c]) { ... }

func(1, 2, 3);        // ✅ 可以：按位置传递
// func(1, c: 3);     // ❌ 错误：不能按名称传递
// func(1, , 3);      // ❌ 错误：不能跳过中间参数
```

**为什么不能？**
- 可选位置参数通过**位置**识别，编译器不知道 `c: 3` 中的 `c` 是什么
- 如果允许 `func(1, c: 3)`，编译器无法判断这是传给 `b` 还是 `c`

**可选命名参数的优势**：
```dart
void func(int a, {int? b, int? c}) { ... }

func(1);              // ✅ 可以：只传 a
func(1, b: 2);        // ✅ 可以：按名称传递
func(1, c: 3);        // ✅ 可以：跳过 b，只传 c
func(1, c: 3, b: 2);  // ✅ 可以：顺序不重要
```

**为什么可以？**
- 可选命名参数通过**名称**识别，`b: 2` 明确表示传给 `b`
- 编译器通过参数名称就能判断，所以可以跳过中间参数

**使用建议**：
- **参数少、有逻辑顺序** → 用位置参数 `[]`（如：长、宽、高）
- **参数多、需要灵活** → 用命名参数 `{}`（如：用户信息、配置项）
- **需要跳过中间参数** → 必须用命名参数 `{}`

// 方式 3：默认值（不需要可空类型）
class Person3 {
  String name;
  int age;
  String city;
  
  Person3(this.name, [this.age = 0, this.city = 'Unknown']);
  
  void introduce() {
    print('I am $name, $age years old, from $city');
  }
}

// 使用
Person3 p1 = Person3('Alice');                    // age=0, city='Unknown'
Person3 p2 = Person3('Bob', 25);                  // city='Unknown'
Person3 p3 = Person3('Charlie', 30, 'Beijing');  // 传所有参数
```

## Widget 系统

### 什么是 Widget？

在 Flutter 中，**一切都是 Widget**：
- 文本是 Widget
- 按钮是 Widget
- 布局是 Widget
- 甚至应用本身也是 Widget

### Widget 类型

#### 1. StatelessWidget（无状态 Widget）
不会改变状态的 Widget。

```dart
class MyWidget extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Text('Hello Flutter');
  }
}
```

#### 2. StatefulWidget（有状态 Widget）
可以改变状态的 Widget。

```dart
class CounterWidget extends StatefulWidget {
  @override
  _CounterWidgetState createState() => _CounterWidgetState();
}

class _CounterWidgetState extends State<CounterWidget> {
  int count = 0;
  
  @override
  Widget build(BuildContext context) {
    return Column(
      children: [
        Text('Count: $count'),
        ElevatedButton(
          onPressed: () {
            setState(() {
              count++;
            });
          },
          child: Text('Increment'),
        ),
      ],
    );
  }
}
```

## Material Design vs Cupertino

Flutter 提供两套设计风格：

- **Material Design**：Google 的设计语言，用于 Android
- **Cupertino**：Apple 的设计语言，用于 iOS

## 项目结构

```
my_app/
├── lib/
│   └── main.dart          # 应用入口
├── test/                   # 测试文件
├── pubspec.yaml           # 依赖配置
└── README.md
```

## 下一步

了解基础概念后，开始创建 [第一个应用](./03-第一个应用.md)！

